<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contacto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <style>
      #mainMap { height: 450px; width: 100%; }
    </style>
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand fw-bold" href="index.html">PractiSite</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
            <li class="nav-item"><a class="nav-link" href="about.html">Nosotros</a></li>
            <li class="nav-item"><a class="nav-link" href="services.html">Servicios</a></li>
            <li class="nav-item"><a class="nav-link" href="gallery.html">Galería</a></li>
            <li class="nav-item"><a class="nav-link" href="contact.html">Contacto</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="bg-info-subtle py-5 mb-4 border-bottom">
      <div class="container">
        <h1 class="display-6 fw-bold">Contacto</h1>
        <p class="lead">Formulario con validación de Bootstrap.</p>
      </div>
    </header>

    <!-- Main content -->
    <main class="container">
      <div class="row g-4">
        <!-- Formulario extendido -->
        <div class="col-lg-7">
          <form class="needs-validation" novalidate>
            <div class="row g-3">

              <!-- Nombre -->
              <div class="col-md-6">
                <label class="form-label">Nombre</label>
                <input type="text" class="form-control" name="nombre" required>
                <div class="invalid-feedback">Ingrese su nombre.</div>
              </div>

              <!-- Email -->
              <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" class="form-control" name="email" required>
                <div class="invalid-feedback">Ingrese un email válido.</div>
              </div>

              <!-- Teléfono -->
              <div class="col-md-6">
                <label class="form-label">Teléfono</label>
                <input type="tel" class="form-control" name="telefono" placeholder="099 999 9999" required>
                <div class="invalid-feedback">Ingrese un teléfono válido.</div>
              </div>

              <!-- Tipo de consulta -->
              <div class="col-md-6">
                <label class="form-label">Categoria de la consulta</label>
                <select class="form-select" name="tipoConsulta" required>
                  <option value="">Seleccione...</option>
                  <option value="general">General</option>
                  <option value="soporte">Soporte</option>
                  <option value="ventas">Ventas</option>
                </select>
                <div class="invalid-feedback">Seleccione un tipo de consulta.</div>
              </div>

              <!-- Asunto -->
              <div class="col-12">
                <label class="form-label">Asunto</label>
                <input type="text" class="form-control" name="asunto" required>
                <div class="invalid-feedback">Ingrese un asunto.</div>
              </div>

              <!-- Mensaje -->
              <div class="col-12">
                <label class="form-label">Mensaje</label>
                <textarea class="form-control" name="mensaje" rows="5" required></textarea>
                <div class="invalid-feedback">Ingrese un mensaje.</div>
              </div>

              <!-- Archivo adjunto -->
              <div class="col-12">
                <label class="form-label">Archivo adjunto (opcional)</label>
                <input class="form-control" type="file" name="archivo">
              </div>

              <!-- Términos -->
              <div class="col-12">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" id="terminos" required>
                  <label class="form-check-label" for="terminos">
                    Acepto los términos y condiciones
                  </label>
                  <div class="invalid-feedback">Debe aceptar los términos antes de enviar.</div>
                </div>
              </div>

              <!-- Botones -->
              <div class="col-12 d-flex gap-2">
                <button class="btn btn-primary" type="submit">Enviar</button>
                <button class="btn btn-outline-secondary" type="reset">Limpiar</button>
              </div>

            </div>
          </form>
        </div>

        <!-- Mapa principal y dirección -->
        <div class="col-lg-5">
          <div id="mainMap" class="ratio ratio-4x3 rounded overflow-hidden shadow-sm"></div>
          <div class="mt-3 p-3 bg-light rounded border" id="addressBlock">
            <h6 class="mb-1">Dirección seleccionada:</h6>
            <p class="mb-0" id="addressText">Av. Principal s/n, Portoviejo, Ecuador</p>
            <small id="coordsText">Lat: -1.05, Lon: -79.1</small>
          </div>
        </div>
      </div>
      <div class="mt-4">
        <a class="btn btn-outline-secondary" href="index.html">Volver</a>
      </div>
    </main>

    <!-- Footer con botones -->
    <footer class="mt-auto bg-light border-top py-3">
      <div class="container d-flex justify-content-between align-items-center">
        <small>© 2025 PractiSite</small>
        <div>
          <button class="btn btn-outline-secondary btn-sm me-2" data-bs-toggle="offcanvas" data-bs-target="#menuOffcanvas">Menu</button>
          <button id="toastBtn" class="btn btn-primary btn-sm">Mostrar aviso</button>
        </div>
      </div>
    </footer>

    <!-- Offcanvas Menu -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="menuOffcanvas">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Navegación rápida</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="list-group">
          <li class="list-group-item"><a href="index.html">Inicio</a></li>
          <li class="list-group-item"><a href="about.html">Nosotros</a></li>
          <li class="list-group-item"><a href="services.html">Servicios</a></li>
          <li class="list-group-item"><a href="gallery.html">Galería</a></li>
          <li class="list-group-item"><a href="contact.html">Contacto</a></li>
        </ul>
      </div>
    </div>

    <!-- Toast -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
      <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <strong class="me-auto">PractiSite</strong>
          <small>ahora</small>
          <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body">
          ¡Hola! Esta es una notificación de ejemplo con Bootstrap.
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <script>
      (function(){
        const addressEl = document.getElementById('addressText');
        const coordsEl = document.getElementById('coordsText');

        const mapMain = L.map('mainMap').setView([-1.05, -79.1], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
          attribution: '&copy; OpenStreetMap'
        }).addTo(mapMain);

        let markerMain = L.marker(mapMain.getCenter(), {draggable:true}).addTo(mapMain);

        function updateAddress(lat, lon){
          coordsEl.textContent = `Lat: ${lat.toFixed(5)}, Lon: ${lon.toFixed(5)}`;
          fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}&accept-language=es`)
            .then(r => r.json())
            .then(data => {
              addressEl.textContent = data.display_name || `${lat.toFixed(5)}, ${lon.toFixed(5)}`;
            })
            addressEl.textContent = `${lat.toFixed(5)}, ${lon.toFixed(5)}`;
        }

        updateAddress(-1.05, -79.1);

        mapMain.on('click', e=>{
          const {lat, lng} = e.latlng;
          markerMain.setLatLng([lat,lng]);
          updateAddress(lat, lng);
        });

        markerMain.on('dragend', ()=>{
          const {lat, lng} = markerMain.getLatLng();
          updateAddress(lat, lng);
        });

        // Buscador de direcciones
        const geocoder = L.Control.geocoder({
          defaultMarkGeocode: false,
          placeholder: "Buscar dirección..."
        })
        .on('markgeocode', function(e) {
          const latlng = e.geocode.center;
          markerMain.setLatLng(latlng);
          mapMain.setView(latlng, 16);
          updateAddress(latlng.lat, latlng.lng);
        })
        .addTo(mapMain);

        // Función del Toast
        const toastTrigger = document.getElementById('toastBtn');
        const toastLiveExample = document.getElementById('liveToast');
        if(toastTrigger){
          toastTrigger.addEventListener('click', () => {
            const toast = new bootstrap.Toast(toastLiveExample);
            toast.show();
          });
        }
      })();
    </script>

    <script src="script.js"></script>
  </body>
</html>